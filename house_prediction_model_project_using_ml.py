# -*- coding: utf-8 -*-
"""Copy of House Prediction Model Project Using ML.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1IqQVG79Hd6fIYUfwlLIJMsK56XvgYf58
"""

import pandas as pd
import numpy as np

# Commented out IPython magic to ensure Python compatibility.
from matplotlib import pyplot as plt
import seaborn as sns
# %matplotlib inline

from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

df= pd.read_csv('/content/drive/MyDrive/houseprice.csv')

df.head()

df.shape

df.describe()

df.info()

df.isnull().sum()
miss_val = df.isnull().sum().sort_values(ascending=False)
miss_val = pd.DataFrame(data=df.isnull().sum().sort_values(ascending=False), columns=['MissvalCount'])

miss_val['Percent'] = miss_val.MissvalCount.apply(lambda x : '{:.2f}'.format(float(x)/df.shape[0] * 100))
miss_val = miss_val[miss_val.MissvalCount > 0]
miss_val

df = df.drop(['Id','Alley','PoolQC','Fence','MiscFeature'], axis=1)

df.dropna(inplace=True)

df.shape

sns.distplot(df['SalePrice'])

sns.distplot(np.log(df['SalePrice']))

df['LogOfPrice'] = np.log(df['SalePrice'])
df.drop('SalePrice', axis=1, inplace=True)

y = df.LogOfPrice

df_temp = df.select_dtypes(include=["int64", "float64"])
X = df_temp.drop(["LogOfPrice"], axis = 1)

x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=.25, random_state=3)

lr = LinearRegression()
lr.fit(x_train, y_train)

yr_hat = lr.predict(x_test)

lr_score = lr.score(x_test, y_test)
lr_score